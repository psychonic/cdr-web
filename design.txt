tables

cdr
 cdr_id (PK)
 cdr_hash
 date
  
app
 (all the current app data)
 (serialize filesystems, launchoptions, userdefined, NOT versions)

app_version, app_filesystems, app_launch_options, app_user_defined
 app_id (PK)
 cdr_id (PK)
 cdr_id_last
 (....)

sub
 (all the current sub data)
 (serialize discounts, extended_info, ratelimits)

sub_discounts, sub_extended_info, sub_rate_limits
 sub_id (PK)
 cdr_id (PK)
 cdr_id_last
 (.....)

apps_subs
 app
 sub
 cdr_id (CDR this pair first appeared in, allows us to select history so we don't see new apps added to subs)

sub_state_capture
 cdr_id
 (sub info before it changes, null otherwise)

app_state_capture
 cdr_id
 (app info before it changes, null otherwise)